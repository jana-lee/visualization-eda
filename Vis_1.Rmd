---
title: "Viz 1_EDA"
author: "Jana Lee"
date: "9/26/2019"
output: html_document
---
# viz_and_eda

This is the repo for examples related to Viz and EDA.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Load in tidyverse and ggridges.
```{r}
library(tidyverse)
library(ggridges)
```

Loading in rnoaa package, the r package that loads in national weather service data. They make data publicly available. This will be the dataset we are going to use
```{r}
weather_df = 
  rnoaa::meteo_pull_monitors(c("USW00094728", "USC00519397", "USS0023B17S"),
                      var = c("PRCP", "TMIN", "TMAX"), 
                      date_min = "2017-01-01",
                      date_max = "2017-12-31") %>%
  mutate(
    name = recode(id, USW00094728 = "CentralPark_NY", 
                      USC00519397 = "Waikiki_HA",
                      USS0023B17S = "Waterhole_WA"),
    tmin = tmin / 10,
    tmax = tmax / 10) %>%
  select(name, id, everything())
```

## create a ggplot
The follow below happens because we definied the dataset itself and the x and y axes. However, we haven't told it what plot we are going to make yet.
```{r}
ggplot(weather_df, aes(x = tmin, y = tmax))

# adding geompoint allows us to plot this.
ggplot(weather_df, aes(x = tmin, y = tmax)) + geom_point()
```

An alternate way of making this plot. Creating a plot and printing it in the same step.
```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point()
```

Saving Initial plots.
```{r}
scatterplot = 
  weather_df %>%
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point()

# this is useful when you want to create a plot and you want to save it into an initial folder for people to reference.
scatterplot
```

Adding color.
alpha blending takes a value that's not completely transparent. Get a little bit of transparency.
```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point(aes(color = name, alpha = .40))
```

Why do aes positions matter?
Turn of SE (standard errors - False)
first:
```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point(aes(color = name, alpha = .40)) +
  geom_smooth (se = FALSE)
```

vs. 

second
```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax, color = name)) +
  geom_point(aes(color = name, alpha = .40)) +
  geom_smooth (se = FALSE)
```

Facets
This produces 3 different graphs with name in the columns! Separated out by 3 distinct panels. Which of these is better is a matter of judgment.
- harder to do comparisons between each of the curves
```{r}
ggplot(weather_df, aes(x = tmin, y = tmax, color = name)) + 
  geom_point(alpha = .5) +
  geom_smooth(se = FALSE) + 
  facet_grid(. ~ name)
```

But now I want to see the seasonal trend of precipitation! Geom_point = aes makes big dots.
```{r}
weather_df %>%
  ggplot(aes(x = date, y = tmax, color = name)) +
  geom_point(aes(size = prcp), alpha = .5) +
  geom_smooth(size = 2, se = FALSE)

```

## some extra stuff
You can remove the data points by eliminating the geom points. You can pick and choose what you want to show. Geom that we pick are up to us!
```{r}
ggplot(weather_df, aes(x = date, y = tmax, color = name)) + 
  geom_smooth(se = FALSE)
```

2d Density
```{r}
weather_df %>%
  ggplot(aes(x = tmin, y = tmax)) +
  geom_bin2d()

```

## Univariate plots
Creating a histogram for the x variable of max temperatures.You can add fill to fill in the bars, as compared to color = name.
```{r}
weather_df %>%
  ggplot(aes(x = tmax, fill = name)) +
  geom_histogram()
```

If we don't like stacked histograms, we can use position = dodge.
```{r}
weather_df %>%
  ggplot(aes(x = tmax, fill = name)) + 
  geom_histogram(position = "dodge", binwidth = 2)
```

Seeing surface area under curve. Pretty!
```{r}
weather_df %>%
  ggplot(aes(x = tmax, fill = name)) + 
  geom_density(alpha = .3)
```

Boxplots
```{r}
weather_df %>%
  ggplot(aes(x = name, y = tmax)) +
  geom_boxplot(alpha = .3)
```

Violin plots
```{r}
weather_df %>%
  ggplot(aes(x = name, y = tmax)) +
  geom_violin()
```

```{r}
ggplot(weather_df, aes(x = name, y = tmax)) + 
  geom_violin(aes(fill = name), color = "blue", alpha = .5) + 
  stat_summary(fun.y = median, geom = "point", color = "blue", size = 4)
```

Ridge plots
```{r}
weather_df %>%
  ggplot(aes(x = tmax, y = name)) +
  geom_density_ridges(scale = .85)
```

